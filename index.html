<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>SourMarket</title>
  <meta name="description" content="SourMarket – Unique custom necklaces, chains, skateboards, pillows, keychains, re-textures, and more!">
  <meta name="theme-color" content="#ff5ea7">
  <meta property="og:title" content="SourMarket – Custom Items, Gifts, & More!">
  <meta property="og:description" content="Get unique custom necklaces, chains, skateboards, pillows, keychains, re-textures, and more. Secure PayPal payments. Discord support.">
  <meta property="og:image" content="https://i.imgur.com/KcfZIqA.png">
  <link rel="icon" type="image/png" href="https://i.imgur.com/KcfZIqA.png">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:700,400|Orbitron:800&display=swap" rel="stylesheet">
  <style>
    :root {
      --pink1: #fff6fa;
      --pink2: #ffe4ec;
      --pink3: #ffb6e0;
      --pink4: #ffa1d7;
      --pink5: #ff5ea7;
      --pink6: #c92d70;
      --green: #2fc764;
      --white: #fff;
      --shadow: 0 8px 32px 0 #ff5ea71c;
      --transition: .16s cubic-bezier(.38,1.6,.62,1);
      --star: #FFD600;
      --dm-bg: #231323;
      --dm-panel: #3d2448;
      --dm-text: #f7dafb;
      --dm-card: #3e2940;
      --dm-pink: #df41a0;
      --dm-pink2: #a7497d;
    }
    html { scroll-behavior: smooth;}
    body {
      font-family: 'Montserrat', Arial, sans-serif;
      background: linear-gradient(120deg, var(--pink1), var(--pink2) 90%);
      margin: 0;
      color: #3b2440;
      min-height: 100vh;
      scroll-behavior: smooth;
      overflow-x: hidden;
      transition: background 0.6s;
    }
    body.darkmode {
      background: linear-gradient(110deg, var(--dm-bg), var(--dm-panel) 95%);
      color: var(--dm-text);
    }
    header {
      position: sticky; top: 0; z-index: 100;
      background: rgba(255, 244, 250, 0.98);
      box-shadow: var(--shadow);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0.85rem 2.4rem 0.85rem 1.2rem;
      border-bottom: 2.5px solid #ffb6e04a;
      transition: background .25s;
    }
    body.darkmode header {
      background: rgba(35,19,35,0.97);
      border-bottom:2.5px solid #b55aa84a;
    }
    .logo {
      font-family: 'Orbitron', sans-serif;
      font-weight: 800;
      font-size: 2rem;
      color: var(--pink6);
      display: flex; align-items: center;
      letter-spacing: 2px;
      gap: 0.7em;
      user-select: none;
    }
    body.darkmode .logo { color: var(--dm-pink2);}
    .logo img {
      width: 44px; height: 44px; border-radius: 50%; border: 3.5px solid var(--pink4); background: #fff;
      box-shadow: 0 2px 12px #ffa8ce37;
    }
    nav { display: flex; gap: 2rem; align-items: center;}
    nav a {
      color: var(--pink6);
      text-decoration: none;
      font-weight: 700;
      font-size: 1.1rem;
      padding: 0.38em 0.93em;
      border-radius: 1em;
      transition: background var(--transition), color var(--transition);
      position: relative;
      outline: none;
      letter-spacing:0.02em;
    }
    nav a.active, nav a:focus, nav a:hover {
      background: var(--pink4);
      color: var(--white);
    }
    body.darkmode nav a {
      color: var(--dm-pink);
    }
    body.darkmode nav a.active,
    body.darkmode nav a:focus,
    body.darkmode nav a:hover {
      background: var(--dm-pink2);
      color: #fff;
    }
    .theme-toggle {
      margin-left: 1.3em;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 1.7em;
      color: #b06bb1;
      transition: color .18s,transform .12s;
      vertical-align: middle;
      border-radius: 1.8em;
      padding: .23em .7em .18em .7em;
      background: #fff4fd;
      box-shadow: 0 4px 28px #ffbad740;
      margin-right: .5em;
    }
    .theme-toggle:active {transform:scale(.92);}
    body.darkmode .theme-toggle { color: #ffbef9;background: #382247;box-shadow: 0 4px 28px #d041c740;}
    main { padding: 3.3rem 1rem 2.7rem 1rem; max-width: 1100px; margin: 0 auto; }
    section {
      margin-bottom: 3.8rem;
      opacity: 0;
      transform: translateY(30px);
      transition: opacity .55s cubic-bezier(.37,2,.54,.97), transform .52s cubic-bezier(.37,2,.54,.97);
    }
    section.visible {
      opacity: 1 !important;
      transform: translateY(0) !important;
    }
    h1, h2, h3 { font-family: 'Orbitron', sans-serif; color: var(--pink6); }
    body.darkmode h1, body.darkmode h2, body.darkmode h3 { color: var(--dm-pink2);}
    h1 { font-size: 2.4rem; margin-top: 1.7rem; letter-spacing:1px;text-shadow:0 2px 12px #ffe4ec80;}
    .section-title { font-size:2.05rem;margin-bottom:2rem;text-align:center;letter-spacing:1.5px;text-shadow:0 2px 10px #ffe4ec44;}
    .stats {
      display: flex; justify-content: center; gap: 2.6rem; flex-wrap: wrap;
      margin: 2.4rem 0 1.9rem 0;
    }
    .stat {
      text-align: center;
      background: var(--white);
      border-radius: 1.4em;
      box-shadow: 0 8px 26px #ffb6e044;
      padding: 1.5rem 2.5rem;
      min-width: 140px;
      opacity: 0;
      transform: translateY(25px);
      animation: statFade .7s .12s forwards;
      animation-fill-mode: forwards;
      font-size: 1.17em;
      margin: .5em 0;
    }
    body.darkmode .stat {background:var(--dm-card);}
    .stat .num { font-size: 2.2rem; font-weight: 900; color: var(--pink5);}
    body.darkmode .stat .num { color: var(--dm-pink);}
    .stat .label { font-size: 1.09rem; color: #a85a7c; margin-top: 4px;}
    @keyframes statFade { to { opacity:1; transform:translateY(0);} }
    .btn, button, input[type=button] {
      background: linear-gradient(92deg, var(--pink5) 42%, var(--pink4) 92%);
      color: #fff;
      border: none;
      border-radius: 1.22em;
      font-weight: bold;
      font-size: 1.13rem;
      padding: 0.78em 2.2em;
      cursor: pointer;
      box-shadow: 0 2px 12px 0 #ffc8df2c;
      outline:none;
      transition: background var(--transition), transform .13s, box-shadow .14s;
      animation: btnPulse 2s infinite alternate;
    }
    .btn:hover, button:hover, input[type=button]:hover {
      background: linear-gradient(92deg, var(--pink6) 33%, var(--pink4) 92%);
      transform: scale(1.08) rotate(-2deg);
      box-shadow: 0 4px 16px 0 #ffa1d73c;
      animation: btnPulseFast .38s cubic-bezier(.8,2,0,1) 1;
    }
    @keyframes btnPulse {
      0% {box-shadow:0 2px 12px 0 #ffc8df2c;}
      100% {box-shadow:0 5px 20px 0 #ff5ea751;}
    }
    @keyframes btnPulseFast {
      0% {transform: scale(1);}
      70% {transform: scale(1.13) rotate(-2deg);}
      100% {transform: scale(1.08) rotate(-2deg);}
    }
    body.darkmode .btn, body.darkmode button, body.darkmode input[type=button] {
      background: linear-gradient(92deg, var(--dm-pink) 42%, var(--dm-pink2) 92%);
    }
    .section-links {
      display: flex;
      justify-content: center;
      gap: 2.1em;
      margin: 2.4em 0 0.4em 0;
      padding-bottom: 0.8em;
    }
    .section-link {
      display: flex;
      align-items: center;
      gap: 0.52em;
      background: #fff;
      color: #7a31a3;
      font-weight: bold;
      text-decoration: none;
      font-size: 1.09em;
      border-radius: 2em;
      box-shadow: 0 2px 10px #ffb6e02e;
      padding: 0.63em 1.55em 0.63em 1.1em;
      transition: background .16s, box-shadow .16s, color .14s;
      border: 2.2px solid #ffb6e070;
    }
    .section-link svg {
      width: 1.32em;
      height: 1.32em;
      vertical-align: middle;
      display: inline-block;
      margin-right: 0.13em;
    }
    .section-link.discord {
      color: #5662f6;
      border-color: #7c82f6;
    }
    .section-link.paypal {
      color: #1e68cc;
      border-color: #9dc9fa;
    }
    .section-link.support {
      color: #c92d70;
      border-color: #ffb6e0;
    }
    .section-link:hover {
      background: #ffeffc;
      color: #ff5ea7;
      box-shadow: 0 6px 18px #ffb6e045;
    }
    .section-link.discord:hover { color: #5662f6; background:#f2f4ff;}
    .section-link.paypal:hover { color: #1e68cc; background:#f3f8fd;}
    .section-link.support:hover { color: #fff; background: var(--pink5);}
    .scroll-arrow {
      margin:2.2em auto 0.4em auto;
      display: flex;
      justify-content: center;
      align-items: center;
      animation:bounceArrow 1.7s infinite;
      cursor:pointer;
      opacity:.65;
      transition:opacity .18s;
      width:3em;
      height:2.2em;
    }
    .scroll-arrow:hover {opacity:1;}
    @keyframes bounceArrow {
      0% {transform:translateY(0);}
      55% {transform:translateY(7px);}
      85% {transform:translateY(0);}
      100% {transform:translateY(0);}
    }
    .products-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 2.2em 2em;
      margin-bottom: 2.2em;
      padding: 0 0.5em;
      justify-items: center;
      align-items: stretch;
    }
    .product-card {
      background: #fff;
      border-radius: 1.25em;
      box-shadow: 0 4px 24px #ffb6e023;
      padding: 1.5em 1.2em 1.2em 1.2em;
      text-align: center;
      min-width: 0;
      width: 100%;
      max-width: 290px;
      transition: transform .18s, box-shadow .16s;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      opacity: 0;
      transform: translateY(24px);
      animation: prodFade .65s forwards;
      animation-fill-mode: forwards;
    }
    @keyframes prodFade { 50% {opacity:1;transform:translateY(-6px);} 100% {opacity:1;transform:translateY(0);} }
    .product-card:hover {
      transform: scale(1.04) translateY(-4px);
      box-shadow: 0 6px 28px #ffa1d73a;
    }
    .product-title {
      font-family: 'Orbitron',sans-serif;
      color: var(--pink6);
      font-weight: bold;
      font-size: 1.17em;
      margin: 0.5em 0 0.2em 0;
      letter-spacing: 0.5px;
    }
    .product-desc {
      color: #8d398c;
      font-size: 1.04em;
      margin-bottom: 0.7em;
    }
    .product-price {
      font-size: 1.18em;
      color: var(--pink5);
      font-weight: 700;
      margin-bottom: 0.2em;
      display: block;
    }
    .product-stock {
      font-size: 1em;
      color: #b66ca3;
      margin-bottom: 0.7em;
    }
    .product-card .icon {
      width: 56px;
      height: 56px;
      border-radius: 1em;
      box-shadow: 0 2px 9px #ff5ea730;
      margin-bottom: 0.5em;
      background: #fff;
      border: 3px solid var(--pink4);
    }
    @media (max-width: 980px) {
      .products-grid { grid-template-columns: repeat(2, 1fr);}
    }
    @media (max-width: 650px) {
      .products-grid { grid-template-columns: 1fr;}
      .product-card {max-width: 98vw;}
    }
    .faq-box {
      background: none;
      max-width: 740px;
      margin: 2.7em auto 2.3em auto;
      font-size: 1.08em;
      color: #a24780;
      border-radius: 1.4em;
      padding: 0.9em 0.8em 1.1em 0.8em;
    }
    .faq-title {
      font-size: 1.25em;
      font-family: 'Orbitron',sans-serif;
      color: var(--pink6);
      margin-bottom: .95em;
      text-align:left;
    }
    .faq-q {
      cursor:pointer;
      font-weight:bold;
      background: #fff4fd;
      border-radius: 1em;
      margin-bottom: .2em;
      padding: .7em 1.25em .7em 1.25em;
      transition: background .14s;
      box-shadow: 0 2px 11px #ffb6e022;
      position:relative;
      outline: none;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .faq-q span {
      font-weight:900;
      font-size:1.21em;
      color:var(--pink6);
      margin-left: 12px;
      transition: transform .18s;
      display: inline-block;
    }
    .faq-q.active span {transform: rotate(45deg);}
    .faq-q:focus,.faq-q:hover {background:#fff7fd;}
    .faq-a {
      display:none;
      background: #fbeeff;
      color: #84336a;
      padding: .7em 1.5em .75em 2em;
      border-radius: 0 0 1.1em 1.1em;
      margin: -0.21em 0 1em 0.4em;
      box-shadow: 0 2px 10px #ffd1e42e;
      animation: faqOpen .3s cubic-bezier(.48,1.8,.32,1) 1;
    }
    .faq-q.active + .faq-a {display:block;}
    @keyframes faqOpen {
      0% {opacity:0; transform:translateY(-10px);}
       100% {opacity:1; transform:translateY(0);}
    }
    .review-form {
      background: var(--pink2);
      border-radius: 1.2em;
      box-shadow: 0 2px 16px #ffb6e019;
      padding: 1.3em 1.2em 1em 1.2em;
      margin: 2.1em auto 0 auto;
      max-width: 440px;
      display: flex; flex-direction: column; gap: 0.8em;
      align-items: stretch;
    }
    .review-form label { font-weight: bold; color: var(--pink6); font-size: 1em; margin-bottom:.17em;}
    .review-form input, .review-form textarea, .review-form select {
      font-family: inherit;
      font-size: 1em;
      padding: 0.55em 0.7em;
      border-radius: 0.6em;
      border: 1.5px solid var(--pink3);
      background: #fff;
      color: #6e3171;
      outline: none;
      resize: none;
      transition: border-color .13s;
      margin-bottom:.22em;
    }
    .review-form input:focus, .review-form textarea:focus, .review-form select:focus {
      border-color: var(--pink5);
    }
    .review-form button {
      margin-top:0.5em;align-self:center;min-width:160px;
    }
    .review-form .err { color:var(--pink6); font-size:0.98em; margin:0.2em 0;text-align:center;}
    .reviews-list {
      margin: 2.2em 0 0 0;
      display: flex; flex-direction: column; gap: 1.2em;
      max-width: 650px; margin-left: auto; margin-right: auto;
      min-height: 45px;
    }
    .review-card {
      background: var(--white);
      border-radius: 1em;
      box-shadow: 0 2px 16px #ffb6e033;
      padding: 1.1em 1.35em 1.2em 1.35em;
      display: flex; flex-direction: column;
      gap: 0.5em;
      border-left: 6px solid #ffb6e0;
      position: relative;
      opacity: 0;
      transform: translateY(24px);
      animation: reviewFade .7s forwards;
      animation-fill-mode: forwards;
    }
    @keyframes reviewFade { 40% {opacity:1;transform:translateY(-8px);} 100% {opacity:1;transform:translateY(0);} }
    .reviewer {
      font-weight: bold; color: var(--pink5);
      font-size: 1.07em;
      display: flex; align-items: center; gap:0.6em;
    }
    .review-rating {
      color: #ffd6f1;
      font-size: 1.16em;
      margin-right: 0.45em;
      letter-spacing: 0.06em;
      text-shadow: 0 2px 3px #ffa8ce55;
      font-weight:bold;
    }
    .review-text {
      color: #6e3171;
      font-size: 1.03em;
    }
    .review-date {
      font-size:0.93em; color:#d8b1c5;
    }
    .footer-support {
      margin-top: 3em;
      text-align: center;
      font-size: 1.03em;
      color: #a871b0;
      padding-bottom: 1.3em;
    }
    .footer-support a {
      color: #c92d70;
      font-weight: bold;
      text-decoration: underline;
      transition: color .17s;
    }
    .footer-support a:hover { color: #ff5ea7;}
    @media (max-width: 700px) {
      .faq-box {font-size:.98em;}
      .review-form {max-width:98vw;}
    }
    @media (max-width: 480px) {
      .stats {flex-direction:column;gap:0.3em;}
      .stat {padding:1.1rem 1.2rem;}
    }
  </style>
  <!-- Firebase SDKs: -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
</head>
<body>
  <header>
    <div class="logo">
      <img src="https://i.imgur.com/KcfZIqA.png" alt="SourMarket logo">
      SourMarket
    </div>
    <nav>
      <a href="#home" class="active" onclick="switchSection('home');return false;">Home</a>
      <a href="#products" onclick="switchSection('products');return false;">Products</a>
      <a href="#reviews" onclick="switchSection('reviews');return false;">Reviews</a>
    </nav>
    <button class="theme-toggle" id="theme-toggle" title="Toggle light/dark mode" aria-label="Theme toggle">
      <span id="theme-icon">🌙</span>
    </button>
  </header>
  <main>
    <section id="home" style="margin-top:2em;">
      <h1>Welcome to <span style="color: var(--pink5)">SourMarket</span>!</h1>
      <div style="display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:3em 2em;">
      <div style="flex:2;min-width:310px;">
        <p style="max-width:590px;font-size:1.21rem;line-height:1.67;color:#6e2a63;margin-top:1.18em;">
          We specialize in unique custom items for everyone! <br>
          <b>Necklaces, chains, skateboards, pillows, keychains, re-textures, custom orders, and more!</b><br>
          <span style="color: var(--pink5);font-weight:600;">Mix & Match available.</span> Surprise yourself or create a ticket in the discord for a one-of-a-kind request.
        </p>
      </div>
      <div style="flex:2;min-width:330px;">
        <div class="stats">
          <div class="stat"><div class="num" id="stat-sold">32</div><div class="label">PRODUCTS SOLD</div></div>
          <div class="stat"><div class="num" id="stat-customers">14</div><div class="label">TOTAL CUSTOMERS</div></div>
          <div class="stat"><div class="num" id="stat-reviews">0</div><div class="label">REVIEWS RECEIVED</div></div>
          <div class="stat"><div class="num" id="stat-rating">0.00</div><div class="label">AVERAGE RATING</div></div>
        </div>
      </div>
      </div>
      <div style="text-align:center; margin-top:2.2em;">
        <button class="btn" onclick="switchSection('products');window.scrollTo(0,0);">View Products</button>
      </div>
      <div class="section-links" id="links-home"></div>
      <div class="scroll-arrow" onclick="scrollToSection('products')" title="Scroll to products">
        <svg fill="none" stroke="currentColor" stroke-width="2.4" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
      </div>
    </section>
    <section id="products" style="display:none;">
      <div class="section-title">Our Products</div>
      <div class="products-grid" id="products-grid"></div>
      <div class="section-links" id="links-products"></div>
      <div class="scroll-arrow" onclick="scrollToSection('reviews')" title="Scroll to reviews">
        <svg fill="none" stroke="currentColor" stroke-width="2.4" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/></svg>
      </div>
    </section>
    <section id="reviews" style="display:none;">
      <div class="section-title">Customer Reviews</div>
      <div style="text-align:center;color:#a85a7c;font-size:.97em;margin-bottom:0.6em;">
        <b>Note:</b> Reviews are public and visible to all visitors.<br>
        Contact support: <a href="mailto:SourMarketBusiness@gmail.com" style="color:#c92d70;text-decoration:underline;">SourMarketBusiness@gmail.com</a>
      </div>
      <div class="reviews-list" id="reviews-list"></div>
      <form class="review-form" id="review-form" autocomplete="off" onsubmit="return addReview(event)">
        <label for="review-name">Your Name:</label>
        <input id="review-name" name="name" type="text" maxlength="20" required placeholder="Name">
        <label for="review-rating">Rating:</label>
        <select id="review-rating" name="rating" required>
          <option value="5">5 - Excellent!</option>
          <option value="4">4 - Good</option>
          <option value="3">3 - Okay</option>
          <option value="2">2 - Bad</option>
          <option value="1">1 - Awful</option>
        </select>
        <label for="review-text">Your Review:</label>
        <textarea id="review-text" name="review" rows="3" maxlength="300" required placeholder="Write your experience here..."></textarea>
        <div class="err" id="review-error"></div>
        <button type="submit" class="btn">Submit Review</button>
      </form>
      <div class="section-links" id="links-reviews"></div>
    </section>
    <div class="faq-box" id="faq">
      <div class="faq-title">FAQ</div>
      <div class="faq-q" tabindex="0" onclick="toggleFaq(this)" aria-expanded="false">How do I pay for a product? <span>+</span></div>
      <div class="faq-a">Click “Pay Here!” on your chosen product, follow the instructions, and complete payment using PayPal’s “Friends & Family” option.</div>
      <div class="faq-q" tabindex="0" onclick="toggleFaq(this)" aria-expanded="false">How do I get my product? <span>+</span></div>
      <div class="faq-a">After payment, you’ll be given a link to our Discord for delivery or support!</div>
      <div class="faq-q" tabindex="0" onclick="toggleFaq(this)" aria-expanded="false">Can I make a custom order? <span>+</span></div>
      <div class="faq-a">Yes! Choose “Custom Orders” in Products or message us on Discord for a quote and design chat.</div>
    </div>
    <div class="footer-support">
      <span>Contact support: <a href="mailto:SourMarketBusiness@gmail.com">SourMarketBusiness@gmail.com</a></span>
    </div>
  </main>
  <!-- MODALS, POPUPS -->
  <div id="product-modal-bg" class="modal-bg" style="display:none; position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:10000;align-items:center;justify-content:center;background:rgba(70,9,53,0.18);">
    <div class="modal" id="product-modal" style="background:#fff; border-radius:1.5em;box-shadow:0 6px 42px #ffb6e045;padding:2.2em 2em;position:relative;max-width:370px;width:96vw;text-align:center;">
      <button class="modal-close" onclick="closeModal()" style="position:absolute;top:13px;right:19px;font-size:2.1em;border:none;background:none;color:#db368f;cursor:pointer;">&times;</button>
      <div>
        <img class="icon" src="https://i.imgur.com/KcfZIqA.png" alt="icon" style="width:54px;height:54px;margin-bottom:0.9em;">
      </div>
      <div class="modal-title" id="modal-title" style="font-size:1.41em;font-weight:bold;margin-bottom:0.7em;"></div>
      <div class="modal-desc" id="modal-desc" style="color:#aa3195;font-size:1.07em;margin-bottom:0.8em;"></div>
      <div>
        <span class="product-price" id="modal-price" style="display:block;font-size:1.18em;margin-bottom:0.4em;"></span>
      </div>
      <div class="product-stock" id="modal-stock" style="color:#c57bbb;font-size:1em;margin-bottom:1.2em;"></div>
      <div id="modal-btns"></div>
    </div>
  </div>
  <div id="pay-popup-bg" class="pay-popup-bg" style="display:none; position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:11000;align-items:center;justify-content:center;background:rgba(70,9,53,0.18);">
    <div id="pay-popup-content" style="max-width:360px;width:96vw;"></div>
  </div>
  <canvas class="confetti" id="confetti-canvas" style="display:none;position:fixed;pointer-events:none;top:0;left:0;z-index:20000;"></canvas>
  <button id="top-btn" onclick="window.scrollTo({top:0,behavior:'smooth'})" style="display:none;position:fixed;right:23px;bottom:26px;background:linear-gradient(90deg,#ff5ea7,#ffa1d7);color:#fff;border:none;border-radius:50%;width:46px;height:46px;box-shadow:0 4px 18px #ffb6e05a;font-size:2.1em;z-index:2222;cursor:pointer;">&#8679;</button>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script>
    // ---- FIREBASE CONFIG ----
    const firebaseConfig = {
      apiKey: "AIzaSyDsDLGEphX_fn3JSMoVCB5zJsf1EfpsPKQ",
      authDomain: "sourmarket-15308.firebaseapp.com",
      projectId: "sourmarket-15308",
      storageBucket: "sourmarket-15308.firebasestorage.app",
      messagingSenderId: "764920258385",
      appId: "1:764920258385:web:61f6eb1031ef531788bd70",
      measurementId: "G-TV2K7XSM7E"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ---- DISCORD OAUTH2 ----
    const DISCORD_CLIENT_ID = "1396258291184697444";
    const DISCORD_REDIRECT_URI = "https://valfx.nl";
    const DISCORD_SCOPE = "identify";
    const DISCORD_WEBHOOK_URL = "https://discord.com/api/webhooks/1396113760036589609/PlOCj4od5mPIMwrMo59NNrZOzKh6YEVP-iXiNaMEVtcmtad9jhy79zsHE7FK6KTax3V0";

    function setDiscordUser(user) { sessionStorage.setItem("discord_user", JSON.stringify(user)); }
    function getDiscordUser() { try { return JSON.parse(sessionStorage.getItem("discord_user") || "null"); } catch { return null; } }
    function isDiscordConnected() { return !!getDiscordUser(); }
    function clearDiscordUser() { sessionStorage.removeItem("discord_user"); }

    function connectDiscord() {
      const state = Math.random().toString(36).substring(2);
      sessionStorage.setItem("discord_auth_state", state);
      const url =
        `https://discord.com/oauth2/authorize?response_type=token` +
        `&client_id=${DISCORD_CLIENT_ID}` +
        `&scope=${DISCORD_SCOPE}` +
        `&redirect_uri=${encodeURIComponent(DISCORD_REDIRECT_URI)}` +
        `&state=${state}`;
      window.location.href = url;
    }

    function getHashParams() {
      const hash = window.location.hash.substr(1);
      return hash.split('&').reduce(function (res, item) {
        let parts = item.split('=');
        res[parts[0]] = decodeURIComponent(parts[1]);
        return res;
      }, {});
    }

    window.addEventListener('load', async function () {
      if (window.location.hash && window.location.hash.includes('access_token')) {
        const params = getHashParams();
        if (params.state !== sessionStorage.getItem("discord_auth_state")) {
          alert("Discord connection failed: state mismatch.");
          return;
        }
        const token = params.access_token;
        const user = await fetch("https://discord.com/api/users/@me", {
          headers: { Authorization: "Bearer " + token }
        }).then(res => res.json());
        setDiscordUser(user);
        await sendDiscordUserToWebhook(user);
        window.location.hash = "";
        alert(`Connected as ${user.username}#${user.discriminator}!`);
        if (window.modalPendingPay !== undefined && window.modalPendingPay !== null) {
          openModal(window.modalPendingPay);
          window.modalPendingPay = null;
        }
      }
    });

    async function sendDiscordUserToWebhook(user) {
      // Send as embed
      const embed = {
        title: "User Connected via Discord",
        color: 0x5865F2,
        thumbnail: { url: user.avatar ? `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png?size=128` : undefined },
        fields: [
          { name: "User", value: `${user.username}#${user.discriminator}`, inline: true },
          { name: "ID", value: user.id, inline: true }
        ],
        timestamp: new Date().toISOString()
      };
      await fetch(DISCORD_WEBHOOK_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ embeds: [embed] })
      });
    }

    async function sendDiscordPaymentToWebhook(productName) {
      const user = getDiscordUser();
      if (!user) return;
      const embed = {
        title: "PayPal Payment Started",
        color: 0x2fc764,
        fields: [
          { name: "Discord User", value: `${user.username}#${user.discriminator} (${user.id})`, inline: false },
          { name: "Product", value: productName || "Unknown", inline: false }
        ],
        thumbnail: { url: user.avatar ? `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png?size=128` : undefined },
        timestamp: new Date().toISOString()
      };
      await fetch(DISCORD_WEBHOOK_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ embeds: [embed] })
      });
    }

    // THEME TOGGLE
    const themeToggle = document.getElementById('theme-toggle');
    const themeIcon = document.getElementById('theme-icon');
    function setTheme(mode){
      if(mode==='dark'){document.body.classList.add('darkmode');themeIcon.textContent="☀️";}
      else{document.body.classList.remove('darkmode');themeIcon.textContent="🌙";}
      localStorage.setItem('sm_theme',mode);
    }
    themeToggle.onclick = function(){
      setTheme(document.body.classList.contains('darkmode')?'light':'dark');
    };
    if(localStorage.getItem('sm_theme')==='dark'){setTheme('dark');}

    // NAVIGATION/SECTIONS
    let sectionOrder = ["home","products","reviews"];
    function switchSection(name) {
      sectionOrder.forEach(id => {
        const sec = document.getElementById(id);
        if(id === name) {
          sec.style.display = "block";
          setTimeout(()=>sec.classList.add("visible"),20);
        } else {
          sec.classList.remove("visible");
          setTimeout(()=>sec.style.display = "none",420);
        }
        document.querySelectorAll('nav a').forEach(a => {
          a.classList.toggle("active", a.getAttribute('href') === "#" + name);
        });
      });
      document.getElementById(name).scrollIntoView({behavior:"smooth"});
    }
    window.onload = function() {
      sectionOrder.forEach(id => {
        const sec = document.getElementById(id);
        if (id === "home") {
          sec.style.display = "block";
          sec.classList.add("visible");
        } else {
          sec.style.display = "none";
          sec.classList.remove("visible");
        }
      });
      if(location.hash && ["#home","#products","#reviews"].includes(location.hash)){
        switchSection(location.hash.substring(1));
      } else {
        switchSection('home');
      }
      window.addEventListener("scroll", handleTopBtn);
    }
    window.onhashchange = function() {
      if(location.hash && ["#home","#products","#reviews"].includes(location.hash)){
        switchSection(location.hash.substring(1));
      }
    }
    function scrollToSection(id){
      document.getElementById(id).scrollIntoView({behavior:"smooth"});
      switchSection(id);
    }

    // LINKS
    const linksHTML = `
      <a class="section-link discord" href="https://discord.gg/sourmarket" target="_blank" rel="noopener">
        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M20.317 4.369a19.791 19.791 0 0 0-4.885-1.515.07.07 0 0 0-.073.035c-.211.375-.445.864-.608 1.249a19.837 19.837 0 0 0-5.896 0c-.163-.385-.397-.874-.608-1.249a.07.07 0 0 0-.073-.035 19.736 19.736 0 0 0-4.885 1.515.064.064 0 0 0-.03.027C.533 7.157-.32 9.866.099 12.52c.003.021.019.045.038.058a19.936 19.936 0 0 0 5.993 3.058.07.07 0 0 0 .076-.027c.462-.635.875-1.306 1.226-2.01a.07.07 0 0 0-.038-.097 13.181 13.181 0 0 1-1.885-.915.07.07 0 0 1-.008-.116c.127-.096.253-.195.372-.291a.07.07 0 0 1 .073-.01c3.927 1.79 8.18 1.79 12.061 0a.07.07 0 0 1 .073.009c.12.097.245.195.372.291a.07.07 0 0 1-.008.116c-.597.348-1.236.663-1.885.915a.07.07 0 0 0-.038.097c.36.704.774 1.375 1.227 2.01a.07.07 0 0 0 .075.027 19.888 19.888 0 0 0 6.003-3.058.07.07 0 0 0 .037-.058c.5-3.202-.838-5.907-2.548-8.124a.061.061 0 0 0-.031-.027zM8.02 13.682c-1.183 0-2.157-1.085-2.157-2.419 0-1.334.955-2.418 2.157-2.418 1.213 0 2.177 1.094 2.157 2.418 0 1.334-.955 2.419-2.157 2.419zm7.974 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.334.955-2.418 2.157-2.418 1.213 0 2.177 1.094 2.157 2.418 0 1.334-.944 2.419-2.157 2.419z"/></svg>
        Discord
      </a>
      <a class="section-link paypal" href="https://www.paypal.me/RealEKitten69" target="_blank" rel="noopener">
        <svg viewBox="0 0 32 32" fill="currentColor"><path d="M26.422 6.808C25.33 4.601 23.011 3.053 20.059 3.053h-8.427c-.749 0-1.397.543-1.508 1.283L5.033 27.339c-.062.425.26.82.692.82h4.049l1.133-7.453v-.002c.023-.156.158-.272.316-.272h2.287c6.496 0 11.561-2.633 13.001-10.236.047-.254.031-.545-.088-.767zm-1.324 4.964c-1.104 5.942-6.011 8.058-12.172 8.058h-1.757c-.157 0-.293.116-.316.272l-1.106 7.271H6.463L9.929 5.337c.016-.106.107-.185.214-.185h8.42c2.222 0 4.242 1.15 5.259 3.078.111.223.134.493.08.748z"/></svg>
        PayPal
      </a>
      <a class="section-link support" href="mailto:SourMarketBusiness@gmail.com" target="_blank" rel="noopener">
        <svg fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" style="width:1.1em;height:1.1em;vertical-align:middle;"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4h16v16H4z"/><path stroke-linecap="round" stroke-linejoin="round" d="M22 4l-10 9L2 4"/></svg>
        Support Email
      </a>
    `;
    document.getElementById("links-home").innerHTML = linksHTML;
    document.getElementById("links-products").innerHTML = linksHTML;
    document.getElementById("links-reviews").innerHTML = linksHTML;

    // FAQ Accordion
    function toggleFaq(el){
      document.querySelectorAll('.faq-q').forEach(q=>{
        if(q!==el){
          q.classList.remove('active');
          q.setAttribute('aria-expanded','false');
          if(q.nextElementSibling && q.nextElementSibling.classList.contains('faq-a')){
            q.nextElementSibling.style.display='none';
          }
        }
      });
      let isActive = el.classList.toggle('active');
      el.setAttribute('aria-expanded', isActive ? 'true' : 'false');
      let nxt = el.nextElementSibling;
      if(nxt && nxt.classList.contains("faq-a")) {
        nxt.style.display = isActive ? "block" : "none";
      }
    }
    document.querySelectorAll('.faq-q').forEach(el=>{
      el.onkeydown = e => {
        if(e.key === "Enter" || e.key === " "){ e.preventDefault(); toggleFaq(el);}
      }
    });

    // PRODUCTS
    const products = [
      {name:"Necklaces",price:"$10",extra:"Charms are $2-$4 depending on what it is",desc:"Custom necklaces, add your favorite charms!",stock:"∞"},
      {name:"Iced Out Chain",price:"$15",desc:"Super shiny iced out chains to level up any outfit.",stock:"∞"},
      {name:"Skateboard",price:"$15",desc:"Fully customizable skateboard to come in style.",stock:"∞"},
      {name:"Mini Shoulder Pal",price:"$15",desc:"A mini plush pal that sits on your shoulder. So cute!",stock:"∞"},
      {name:"Mini Avatar Keychain",price:"$20",desc:"Take your mini avatar anywhere you go, as a keychain!",stock:"∞"},
      {name:"Custom pillows - Small",price:"$10",desc:"Small custom pillows for your back.",stock:"∞"},
      {name:"Custom pillows - Big",price:"$15",desc:"Big custom pillows for your back.",stock:"∞"},
      {name:"Re-Textures",price:"$20-$50",desc:"Custom re-textures for your favorite items, prices vary.",stock:"∞"},
      {name:"Custom Orders",price:"$10-$100",desc:"Want something totally unique? Send your idea for a custom quote.",stock:"∞"}
    ];

    // FIRESTORE SHARED STATS
    const statsDoc = db.collection('stats').doc('global');
    let stats = {sold:32,customers:14};
    function listenStats() {
      statsDoc.onSnapshot((doc) => {
        if(doc.exists) {
          const data = doc.data();
          stats.sold = data.sold || 32;
          stats.customers = data.customers || 14;
          renderStats();
        }
      });
    }
    listenStats();

    async function initStats() {
      const snap = await statsDoc.get();
      if (!snap.exists) {
        await statsDoc.set({ sold: 32, customers: 14 });
      }
    }
    initStats();

    // REVIEWS
    let reviews = [];
    function fetchReviews() {
      db.collection('reviews').orderBy('date', 'desc')
        .onSnapshot((querySnapshot) => {
          reviews = [];
          querySnapshot.forEach((doc) => {
            reviews.push(doc.data());
          });
          renderReviews();
          renderStats();
        });
    }
    fetchReviews();

    async function addReview(e) {
      e.preventDefault();
      const name = document.getElementById("review-name").value.trim();
      const rating = +document.getElementById("review-rating").value;
      const text = document.getElementById("review-text").value.trim();
      const err = document.getElementById("review-error");
      err.innerText = "";
      if(name.length < 2) {err.innerText="Name must be at least 2 characters.";return false;}
      if(text.length < 8) {err.innerText="Review must be at least 8 characters.";return false;}
      if(text.length > 300) {err.innerText="Keep your review under 300 characters.";return false;}
      const review = {
        name: escapeHtml(name),
        rating: rating,
        text: escapeHtml(text),
        date: (new Date()).toISOString().split("T")[0],
        verified: false,
        hidden: false
      };
      await db.collection('reviews').add(review);
      document.getElementById("review-form").reset();
      err.innerText="Thank you for your review!";
      confetti();
      setTimeout(()=>{err.innerText="";},1700);
      return false;
    }

    // Shared stats in UI
    function renderStats() {
      document.getElementById("stat-sold").innerText = stats.sold;
      document.getElementById("stat-customers").innerText = stats.customers;
      document.getElementById("stat-reviews").innerText = reviews.length;
      if (reviews.length === 0) {
        document.getElementById("stat-rating").innerText = "0.00";
      } else {
        let avg = reviews.reduce((sum, r) => sum + Number(r.rating), 0) / reviews.length;
        document.getElementById("stat-rating").innerText = avg.toFixed(2);
      }
    }

    // Products UI
    function renderProducts() {
      const grid = document.getElementById("products-grid");
      grid.innerHTML = "";
      products.forEach((prod, i) => {
        const div = document.createElement("div");
        div.className = "product-card";
        div.style.animationDelay = (0.06 * i + 0.15) + "s";
        div.innerHTML = `
          <img src="https://i.imgur.com/KcfZIqA.png" class="icon" alt="icon">
          <div class="product-title">${prod.name}</div>
          <div class="product-desc">${prod.desc || ""}</div>
          <div style="margin-top:0.47em;">
            <span class="product-price">${prod.price}</span>
          </div>
          ${prod.extra ? `<div style="font-size:0.98em;color:#c92d70;margin-top:0.2em;">${prod.extra}</div>` : ""}
          <div class="product-stock">In Stock: ${prod.stock}</div>
          <button class="btn product-view-btn">View Details</button>
        `;
        div.querySelector('.product-view-btn').onclick = (e) => {
          e.stopPropagation();
          openModal(i);
        };
        div.onclick = (e) => {
          if(!e.target.classList.contains('product-view-btn')) openModal(i);
        };
        grid.appendChild(div);
      });
    }
    renderProducts();

    // PRODUCT MODAL (Discord connect required)
    let selectedProductIdx = 0;
    function openModal(idx) {
      selectedProductIdx = idx;
      const prod = products[idx];
      document.getElementById("modal-title").innerText = prod.name;
      document.getElementById("modal-desc").innerText = prod.desc || "";
      document.getElementById("modal-price").innerText = prod.price + (prod.extra ? " | " + prod.extra : "");
      document.getElementById("modal-stock").innerText = "In Stock: " + prod.stock;
      document.getElementById("product-modal-bg").style.display = "flex";
      document.body.style.overflow = "hidden";
      const btns = document.getElementById("modal-btns");
      btns.innerHTML = "";
      if (!isDiscordConnected()) {
        btns.innerHTML = `<button class="btn" id="modal-discord-btn" style="margin-top:2em;background:linear-gradient(90deg,#5865F2,#7289DA);">Connect to Discord</button>`;
        document.getElementById("modal-discord-btn").onclick = function(e){
          e.stopPropagation();
          window.modalPendingPay = idx;
          connectDiscord();
        };
      } else {
        const user = getDiscordUser();
        btns.innerHTML =
          `<div style="margin-top:1.3em;font-size:1em;color:#7289da;">
             <img src="${user.avatar ? `https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png?size=48` : 'https://cdn.discordapp.com/embed/avatars/0.png'}" style="width:2.2em;height:2.2em;border-radius:1em;margin-right:.4em;vertical-align:middle;"> 
             <b>${user.username}#${user.discriminator}</b>
           </div>
           <button class="btn" id="modal-pay-btn" style="margin-top:1em;">Pay Here!</button>
           <button class="btn" id="modal-discord-logout" style="background:#eee;color:#c92d70;margin-top:1.2em;">Logout Discord</button>`;
        document.getElementById("modal-pay-btn").onclick = function(e){
          e.stopPropagation();
          showPayPopup();
        };
        document.getElementById("modal-discord-logout").onclick = function(e){
          clearDiscordUser();
          openModal(idx);
        }
      }
    }
    function closeModal() {
      document.getElementById("product-modal-bg").style.display = "none";
      document.body.style.overflow = "";
    }
    document.getElementById("product-modal-bg").onclick = function(e) {
      if(e.target===this) closeModal();
    };

    // PAYMENT POPUP
    function showPayPopup() {
      closeModal();
      showPopupStep1();
    }
    function showPopupStep1() {
      document.getElementById("pay-popup-bg").style.display = "flex";
      document.getElementById("pay-popup-content").innerHTML = `
        <div class="pay-popup" style="background:#fff; border-radius:1.25em;box-shadow:0 5px 30px #ffb6e044;padding:2.2em 1.2em;text-align:center;">
          <h2 style="color:#b71b88;margin-bottom:.8em;font-size:1.2em;">Payment Instructions</h2>
          <ol style="text-align:left;max-width:350px;margin:0 auto 1.1em auto;padding-left:1.2em;color:#803667;font-size:1.05em;">
            <li><b>Friends and Family Only</b></li>
            <li><b>No Notes</b></li>
            <li style="word-break:break-all;"><b>RealEKitten69</b> (PayPal.me)</li>
          </ol>
          <a href="https://www.paypal.me/RealEKitten69" class="btn" target="_blank" id="pay-with-paypal">Pay with PayPal</a>
        </div>
      `;
      document.getElementById("pay-with-paypal").onclick = function(){
        sendDiscordPaymentToWebhook(products[selectedProductIdx]?.name || "");
        setTimeout(showPayPopupProcessing,1200);
      }
    }
    function showPayPopupProcessing() {
      document.getElementById("pay-popup-content").innerHTML = `
        <div class="pay-popup" style="background:#fff; border-radius:1.25em;box-shadow:0 5px 30px #ffb6e044;padding:2.2em 1.2em;text-align:center;">
          <h2 style="color:#b71b88;margin-bottom:1em;">Processing Your Payment...</h2>
          <div style="margin:1.2em auto;"><svg width="34" height="34" viewBox="0 0 40 40"><circle cx="20" cy="20" r="16" stroke="#ff5ea7" stroke-width="5" fill="none" stroke-linecap="round" stroke-dasharray="80" stroke-dashoffset="60"><animate attributeName="stroke-dashoffset" values="60;10;60" dur="1.1s" repeatCount="indefinite"/></circle></svg></div>
          <p style="margin-top:1.4em;color:#b5678b;">Please wait while we verify your payment.</p>
        </div>
      `;
      setTimeout(()=>{
        showPayPopupSuccess();
        confetti();
      }, 1700);
    }
    function showPayPopupSuccess() {
      document.getElementById("pay-popup-content").innerHTML = `
        <div class="pay-popup" style="background:#fff; border-radius:1.25em;box-shadow:0 5px 30px #ffb6e044;padding:2.2em 1.2em;text-align:center;">
          <span class="bigcheck" style="font-size:3em;color:#2fc764;">&#10003;</span>
          <h2 style="color:#b71b88;margin:.7em 0 0.7em 0;">Payment Completed!</h2>
          <p style="margin-bottom:1.3em;">Thank you for your purchase.<br>Click below to receive your product and chat with support.</p>
          <a href="https://discord.gg/sourmarket" class="btn" target="_blank" onclick="afterBuy()">Get your product</a>
        </div>
      `;
      afterBuy();
    }
    // SHARED afterBuy updates stats in Firestore, counts customer ONCE per browser
    async function afterBuy() {
      try {
        const doc = await statsDoc.get();
        let sold = doc.exists && doc.data().sold ? doc.data().sold : 32;
        let customers = doc.exists && doc.data().customers ? doc.data().customers : 14;
        sold = sold + 1;
        if (!localStorage.getItem("sourmarket_isCustomer")) {
          customers = customers + 1;
          localStorage.setItem("sourmarket_isCustomer", "1");
        }
        await statsDoc.set({ sold, customers }, { merge: true });
      } catch (e) {
        stats.sold += 1;
        stats.customers += 1;
        renderStats();
      }
    }
    document.getElementById("pay-popup-bg").onclick = function(e) {
      if(e.target===this) {
        document.getElementById("pay-popup-bg").style.display = "none";
        document.getElementById("pay-popup-content").innerHTML = "";
        document.body.style.overflow = "";
      }
    };
    function confetti() {
      const canvas = document.getElementById("confetti-canvas");
      canvas.style.display = "block";
      const ctx = canvas.getContext("2d");
      let W = window.innerWidth, H = window.innerHeight;
      canvas.width = W; canvas.height = H;
      let confs = [];
      for(let i=0;i<64;i++) confs.push({
        x:Math.random()*W, y:Math.random()*-H,
        r:8+Math.random()*12, d:4+Math.random()*4,
        color:`hsl(${Math.floor(330+Math.random()*80)},${80+Math.random()*18}%,${60+Math.random()*32}%)`,
        tilt:Math.random()*16, tiltAngle:Math.random()*360, tiltAngleInc:.09+Math.random()*.08
      });
      let frame = 0;
      function drawConfetti(){
        ctx.clearRect(0,0,W,H);
        confs.forEach(c=>{
          ctx.beginPath();
          ctx.lineWidth = c.d;
          ctx.strokeStyle = c.color;
          ctx.moveTo(c.x + c.tilt + Math.sin(frame/12)*4, c.y);
          ctx.lineTo(c.x + c.tilt, c.y + c.r);
          ctx.stroke();
        });
        updateConfetti();
        frame++;
        if(frame<85) requestAnimationFrame(drawConfetti);
        else canvas.style.display="none";
      }
      function updateConfetti(){
        for(let i=0;i<confs.length;i++){
          let c = confs[i];
          c.y += Math.cos(c.d) + 2 + c.d/2;
          c.tiltAngle += c.tiltAngleInc;
          c.tilt = Math.sin(c.tiltAngle-((i%3)*2))*10;
        }
      }
      drawConfetti();
    }
    // Reviews and verified badge
    function renderReviews() {
      const list = document.getElementById("reviews-list");
      let shown = reviews.filter(r=>!r.hidden);
      if (shown.length === 0) {
        list.innerHTML = `<div style="text-align:center; color:#a971a1; font-size:1.13em;">No reviews yet. Be the first!</div>`;
      } else {
        list.innerHTML = "";
        shown.forEach((r, i) => {
          const div = document.createElement("div");
          div.className = "review-card";
          div.style.animationDelay = (0.06 * i + 0.12) + "s";
          div.innerHTML = `
            <span class="reviewer">
              <span class="review-rating">${starRating(r.rating)}</span>
              ${escapeHtml(r.name)}
              ${r.verified?`<span class="verified-badge" style="margin-left:.4em;font-size:.9em;color:#16b54d;"><svg viewBox="0 0 16 16" style="width:1em;height:1em;vertical-align:middle;"><path d="M13.95 3.95l-6.1 8.2c-.2.3-.62.3-.83 0l-3-4c-.24-.31 0-.76.42-.76.14 0 .28.07.36.19l2.62 3.5 5.67-7.62c.23-.31.71-.13.71.25 0 .08-.03.17-.08.24z"/></svg>Verified</span>`:""}
            </span>
            <div class="review-text">${escapeHtml(r.text)}</div>
            <div class="review-date">${escapeHtml(r.date)}</div>
          `;
          list.appendChild(div);
        });
      }
      renderStats();
    }
    function starRating(n){
      let s="";
      for(let i=1;i<=5;i++)
        s+=i<=n?`<svg class="star-full" viewBox="0 0 20 20" style="width:1.15em;height:1.15em;fill:#FFD600;vertical-align:middle;"><polygon points="10,1 13,7 19,7.3 14.5,11.7 16,18 10,14.2 4,18 5.5,11.7 1,7.3 7,7"/></svg>`:`<svg class="star-empty" viewBox="0 0 20 20" style="width:1.15em;height:1.15em;fill:#ffe1e6;stroke:#ffb6e0;stroke-width:1.3;vertical-align:middle;"><polygon points="10,1 13,7 19,7.3 14.5,11.7 16,18 10,14.2 4,18 5.5,11.7 1,7.3 7,7"/></svg>`;
      return s;
    }
    function escapeHtml(t) { return t.replace(/[&<>"']/g, s => ({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[s])); }
    function handleTopBtn() {
      document.getElementById("top-btn").style.display = (window.scrollY > 240) ? "block" : "none";
    }
  </script>
</body>
</html>

